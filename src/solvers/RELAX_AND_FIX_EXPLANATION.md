# Объяснение параметров Relax-and-Fix

## Визуализация работы метода

### Параметры:

- **window_size** - размер временного окна (сколько периодов одновременно решаются как MIP)
- **window_step** - шаг сдвига окна (сколько периодов фиксируется после каждой итерации)

### Пример: 12 периодов, window_size=4, window_step=2

```
Итерация 1:
Периоды:    [1] [2] [3] [4] | [5] [6] [7] [8] | [9][10][11][12]
Статус:     [B] [B] [B] [B] | [C] [C] [C] [C] | [C] [C] [C] [C]
Действие:   Решаем как MIP  |    Релаксация   |   Релаксация
После:      [F] [F] [B] [B] | [C] [C] [C] [C] | [C] [C] [C] [C]
            фикс  фикс       |                 |

Итерация 2:
Периоды:    [1] [2] [3] [4] | [5] [6] [7] [8] | [9][10][11][12]
Статус:     [F] [F] [B] [B] | [B] [B] [C] [C] | [C] [C] [C] [C]
Действие:   фиксированы     | Решаем как MIP  |   Релаксация
После:      [F] [F] [F] [F] | [F] [F] [C] [C] | [C] [C] [C] [C]

Итерация 3:
Периоды:    [1] [2] [3] [4] | [5] [6] [7] [8] | [9][10][11][12]
Статус:     [F] [F] [F] [F] | [F] [F] [B] [B] | [B] [B] [C] [C]
Действие:   фиксированы     | фиксированы     | Решаем как MIP
После:      [F] [F] [F] [F] | [F] [F] [F] [F] | [F] [F] [C] [C]

Итерация 4:
Периоды:    [1] [2] [3] [4] | [5] [6] [7] [8] | [9][10][11][12]
Статус:     [F] [F] [F] [F] | [F] [F] [F] [F] | [F] [F] [B] [B]
Действие:   фиксированы     | фиксированы     | Решаем как MIP
После:      [F] [F] [F] [F] | [F] [F] [F] [F] | [F] [F] [F] [F]

Легенда:
[B] - Binary (бинарные переменные, решаем MIP)
[C] - Continuous (релаксированные переменные, 0 <= x <= 1)
[F] - Fixed (зафиксированные переменные)
```

## Влияние параметров

### window_size (размер окна)

**Больше окно → лучше качество, но медленнее:**

- `window_size = 4`: Маленькое окно, быстрые итерации, но может терять глобальную оптимальность
- `window_size = 12`: Большое окно, медленные итерации, но ближе к глобальному оптимуму
- `window_size = 48`: Весь горизонт, эквивалентно прямому решению

**Оптимальные значения:**

- Малые задачи (<100 генераторов): 8-12 периодов
- Большие задачи (>500 генераторов): 4-8 периодов

### window_step (шаг сдвига)

**Меньше шаг → больше перекрытие → лучше качество:**

- `window_step = window_size`: Нет перекрытия, быстро, но менее точно
- `window_step = window_size // 2`: Перекрытие 50%, баланс скорость/качество ✓
- `window_step = window_size // 3`: Перекрытие 67%, медленнее, но точнее

**Пример расчета итераций:**

```python
num_periods = 48
window_size = 8
window_step = 4

# Количество итераций ≈ ceil(num_periods / window_step)
iterations = (num_periods + window_step - 1) // window_step
# = (48 + 4 - 1) // 4 = 12 итераций
```

## Ограничения параметров

### Технические ограничения:

1. `window_size > 0` (минимум 1 период)
2. `window_size <= num_periods` (не больше горизонта)
3. `window_step > 0` (минимум 1 период фиксации)
4. `window_step <= window_size` (рекомендуется для перекрытия)

## Результаты из тестов

### RTS-GMLC (73 генератора, 48 периодов)

| window_size | window_step | Итераций | Время (s) | Objective | Gap (%) |
|-------------|-------------|----------|-----------|-----------|---------|
| 8           | 4           | 12       | 62.99     | 3,729,463 | -0.594  |
| 6           | 3           | 16       | 72.65     | 3,751,629 | -0.003  |
| 12          | 6           | 8        | 40.47     | 3,753,714 | +0.053  |
| 48 (Direct) | -           | 1        | 10.23     | 3,751,739 | 0.000   |

**Выводы:**

- Большое окно (12) дает лучшую скорость на малых задачах
- Маленькое окно (6) дает лучшее качество (gap ближе к 0)
- Прямое решение всё равно быстрее на малых задачах
